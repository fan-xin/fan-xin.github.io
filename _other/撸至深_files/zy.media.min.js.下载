!function(){var e,t,i,r={};function d(e,t){return parseInt(getComputedStyle(e,null).getPropertyValue(t))}function n(e,t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}function a(e,t){e.classList?e.classList.add(t):n(e,t)||(e.className+=""+t)}function s(e,t){e.classList?e.classList.remove(t):n(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}function u(e,t){(!isFinite(e)||e<0)&&(e=0);var i=t.alwaysShowHours?[0]:[];return Math.floor(e/3600)%24&&i.push(Math.floor(e/3600)%24),i.push(Math.floor(e/60)%60),i.push(Math.floor(e%60)),i=i.join(":"),1==t.timeFormatType&&(i=i.replace(/(:|^)([0-9])(?=:|$)/g,"$10$2")),i}function o(){return document.fullscreenElement||document.mozFullScreen||document.webkitIsFullScreen}function l(e,t){return e&&!t?function(e){var t=(e=e.toLowerCase().split("?")[0]).substring(e.lastIndexOf(".")+1),i=/mp4|m4v|ogg|ogv|m3u8|webm|webmv|wmv|mpeg|mov/gi.test(t)?"video/":"audio/";switch(t){case"mp4":case"m4v":case"m4a":return i+"mp4";case"webm":case"webma":case"webmv":return i+"webm";case"ogg":case"oga":case"ogv":return i+"ogg";case"m3u8":return"application/x-mpegurl";case"ts":return i+"mp2t";default:return i+t}}(e):t&&~t.indexOf(";")?t.substr(0,t.indexOf(";")):t}r.config={type:"",mediaTitle:"",nativeControls:!1,autoplay:!1,preload:"none",videoWidth:"100%",videoHeight:"auto",aspectRation:16/9,audioWidth:"100%",audioHeight:44,autoLoop:!1,timeFormatType:1,alwaysShowHours:!1,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,enableFullscreen:!0,pauseOtherPlayers:!0,enableVisibilityState:!0,duration:0,success:null,error:null,enterFullScreenEvent:null,exitFullScreenEvent:null},e=r.features={},t=window.navigator.userAgent.toLowerCase(),i=document.createElement("video"),e.isBustedAndroid=/android 2\.[12]/i.test(t),e.isChromium=/chromium/i.test(t),e.hasTouch="ontouchstart"in window,e.supportsCanPlayType=void 0!==i.canPlayType,e.isPlaysInline=matchMedia("(-webkit-video-playable-inline)").matches,e.isVendorBigPlay=function(){if(window.MSStream)return!1;var e=t.match(/iPhone OS (\d+)_?/i);return!!(e&&e[1]<11)}(),e.isVendorControls=/baidu/i.test(t),e.nativeFullscreenPrefix=i.requestFullScreen?"":i.webkitRequestFullScreen?"webkit":i.mozRequestFullScreen?"moz":i.msRequestFullScreen?"ms":"-",void 0!==document.visibilityState?(e.vChange="visibilitychange",e.vState="visibilityState"):void 0!==document.webkitVisibilityState?(e.vChange="webkitvisibilitychange",e.vState="webkitVisibilityState"):(e.vChange="",e.vState=""),e.hasOldNativeFullScreen="-"==e.nativeFullscreenPrefix&&i.webkitEnterFullscreen,e.hasOldNativeFullScreen&&/mac os x 10_5/i.test(t)&&(e.nativeFullscreenPrefix="-",e.hasOldNativeFullScreen=!1);var c=0;r.players={},r.MediaPlayer=function(e,t){var i,n=this;if(!e.isInstantiated){e.isInstantiated=!0,n.media=e;var a=n.media.tagName.toLowerCase();if(/audio|video/.test(a)){for(i in n.isVideo="video"===a,n.options={},r.config)n.options[i]=r.config[i];try{for(i in t)n.options[i]=t[i];var s=JSON.parse(n.media.getAttribute("data-config"));for(i in s)n.options[i]=s[i]}catch(e){}if(n.options.autoplay&&(n.options.autoplay=!r.features.isVendorAutoplay),n.isVideo||(n.options.alwaysShowControls=!0),n.options.nativeControls||r.features.isVendorControls)n.media.setAttribute("controls","controls");else{var o=n.media.getAttribute("src");o=""===o?null:o,!function(e,t,i){var n,a,s,o=[];if(t.type)if("string"==typeof t.type)o.push({type:t.type,url:i});else for(n=0;n<t.type.length;n++)o.push({type:t.type[n],url:i});else if(null!==i)o.push({type:l(i,e.getAttribute("type")),url:i});else for(n=0;n<e.children.length;n++)1==(a=e.children[n]).nodeType&&"source"==a.tagName.toLowerCase()&&(i=a.getAttribute("src"),o.push({type:l(i,a.getAttribute("type")),url:i}));if(r.features.isBustedAndroid&&(e.canPlayType=function(e){return/video\/(mp4|m4v)/i.test(e)?"maybe":""}),r.features.isChromium&&(e.canPlayType=function(e){return/video\/(webm|ogv|ogg)/i.test(e)?"maybe":""}),r.features.supportsCanPlayType)for(n=0;n<o.length;n++)if("video/m3u8"==o[n].type||""!==e.canPlayType(o[n].type).replace(/no/,"")||""!==e.canPlayType(o[n].type.replace(/mp3/,"mpeg")).replace(/no/,"")||""!==e.canPlayType(o[n].type.replace(/m4a/,"mp4")).replace(/no/,"")){s=!0;break}return s}(n.media,n.options,o)?alert("不支持此"+(n.isVideo?"视":"音")+"频"):(n.id="zym_"+c++,(r.players[n.id]=n).init())}}}},r.MediaPlayer.prototype={isControlsVisible:!0,isFullScreen:!1,setPlayerSize:function(e,t){var i=this;if(null!=e&&"100%"!=e||(i.width=d(i.container,"width")),null==t||"auto"==t){var n=i.media.videoWidth,a=i.media.videoHeight;n&&a&&Math.abs(i.options.aspectRation-n/a)<.1&&(i.options.aspectRation=n/a),i.height=parseInt(i.width/i.options.aspectRation)}i.media.style.width=i.width+"px",i.media.style.height=i.container.style.height=i.height+"px"},showControls:function(){var e=this;e.isControlsVisible||(e.controls.style.bottom=0,e.options.mediaTitle&&(e.title.style.top=0),e.isControlsVisible=!0)},hideControls:function(){var e=this;e.isControlsVisible&&!e.options.alwaysShowControls&&(e.controls.style.bottom="-45px",e.options.mediaTitle&&(e.title.style.top="-35px"),e.isControlsVisible=!1)},setControlsTimer:function(e){var t=this;clearTimeout(t.controlsTimer),t.controlsTimer=setTimeout(function(){t.hideControls()},e)},updateTimeline:function(e){var t=this,i=void 0!==e?e.target:t.media,n=null,a=d(t.slider,"width");if(i.buffered&&0<i.buffered.length&&i.buffered.end&&i.duration?n=i.buffered.end(i.buffered.length-1)/i.duration:void 0!==i.bytesTotal&&0<i.bytesTotal&&void 0!==i.bufferedBytes?n=i.bufferedBytes/i.bytesTotal:e&&e.lengthComputable&&0!==e.total&&(n=e.loaded/e.total),null!==n&&(n=Math.min(1,Math.max(0,n)),t.loaded.style.width=a*n+"px",t.media.paused&&setTimeout(function(){t.loaded.style.width=a*n+"px",t.updateTimeline()},300)),void 0!==t.media.currentTime&&t.media.duration){var s=Math.round(a*t.media.currentTime/t.media.duration);t.current.style.width=s+"px",t.handle.style.left=s-Math.round(d(t.handle,"width")/2)+"px"}},updateTime:function(){var e=this;e.currentTime.innerHTML=u(e.media.currentTime,e.options),(1<e.options.duration||1<e.media.duration)&&(e.durationDuration.innerHTML=u(1<e.options.duration?e.options.duration:e.media.duration,e.options))},enterFullScreen:function(){var e=this;if(null!=e.options.enterFullScreenEvent&&e.options.enterFullScreenEvent(),"-"!=r.features.nativeFullscreenPrefix)e.container[r.features.nativeFullscreenPrefix+"RequestFullScreen"]();else if(r.features.hasOldNativeFullScreen)return void e.media.webkitEnterFullscreen();a(document.documentElement,"zy_fullscreen"),e.media.style.width=e.container.style.width="100%",e.media.style.height=e.container.style.height="100%",a(e.fullscreenBtn,"zy_unfullscreen"),e.isFullScreen=!0},exitFullScreen:function(){var e=this;null!=e.options.exitFullScreenEvent&&e.options.exitFullScreenEvent(),(o()||e.isFullScreen)&&("-"!=r.features.nativeFullscreenPrefix?document[r.features.nativeFullscreenPrefix+"CancelFullScreen"]():r.features.hasOldNativeFullScreen&&document.webkitExitFullscreen()),s(document.documentElement,"zy_fullscreen"),e.setPlayerSize(),e.media.style.width=e.width+"px",e.container.style.width="",e.media.style.height=e.container.style.height=e.height+"px",s(e.fullscreenBtn,"zy_unfullscreen"),e.isFullScreen=!1},buildContainer:function(){var e=this;e.container=e.media.parentNode,e.container.style.overflow="hidden",e.container.style.height=(e.isVideo?d(e.container,"width")/e.options.aspectRation:e.options.audioHeight)+"px",e.container.innerHTML='<div class="zy_wrap"></div><div class="zy_controls"></div>'+(e.options.mediaTitle?'<div class="zy_title">'+e.options.mediaTitle+"</div>":""),e.title=e.container.querySelector(".zy_title"),e.media.setAttribute("preload",e.options.preload),e.isPlaysInline&&e.media.setAttribute("playsinline",""),e.container.querySelector(".zy_wrap").appendChild(e.media),e.controls=e.container.querySelector(".zy_controls"),e.isVideo&&(e.width=e.options.videoWidth,e.height=e.options.videoHeight,"100%"==e.width&&"auto"==e.height&&(e.enableAutoSize=!0),e.setPlayerSize(e.width,e.height))},buildPlaypause:function(){var t=this,i=document.createElement("div");function e(e){(t.media.isUserClick||t.options.autoplay)&&(i.className="play"===e?"zy_playpause_btn_pause":"zy_playpause_btn_play")}i.className="zy_playpause_btn_play",t.controls.appendChild(i),i.addEventListener("click",function(){t.media.isUserClick=!0,t.media.paused?(t.media.play(),t.media.paused||t.options.alwaysShowControls||t.setControlsTimer(3e3)):t.media.pause()}),t.media.addEventListener("play",function(){e("play")}),t.media.addEventListener("playing",function(){e("play")}),t.media.addEventListener("pause",function(){e("pse")}),t.media.addEventListener("paused",function(){e("pse")})},buildTimeline:function(){var n=this,t=document.createElement("div");t.className="zy_timeline",t.innerHTML='<div class="zy_timeline_slider"><div class="zy_timeline_buffering" style="display:none"></div><div class="zy_timeline_loaded"></div><div class="zy_timeline_current"></div><div class="zy_timeline_handle"></div></div>',n.controls.appendChild(t),n.slider=t.children[0],n.buffering=n.slider.children[0],n.loaded=n.slider.children[1],n.current=n.slider.children[2],n.handle=n.slider.children[3];var a=!1,s=n.slider.getBoundingClientRect().left,o=d(n.slider,"width"),l=d(n.handle,"width")/2,i=function(e){e.preventDefault();var t,i=0;t=e.changedTouches?e.changedTouches[0].pageX:e.pageX,n.media.duration&&(t<s?t=s:o+s<t&&(t=o+s),n.handle.style.left=t-l-s+"px",i=(t-s)/o*n.media.duration,n.currentTime.innerHTML=u(n.media.currentTime,n.options),a&&i!==n.media.currentTime&&(n.media.currentTime=i))};r.features.hasTouch?t.addEventListener("touchstart",function(e){a=!0,n.media.pause(),i(e),s=n.slider.getBoundingClientRect().left,o=d(n.slider,"width"),t.addEventListener("touchmove",i),t.addEventListener("touchend",function(e){i(e),a=!1,n.media.play(),n.media.isUserClick=!0,t.removeEventListener("touchmove",i)})}):t.addEventListener("mousedown",function(e){a=!0,n.media.pause(),i(e),s=n.slider.getBoundingClientRect().left,o=d(n.slider,"width"),t.addEventListener("mousemove",i),t.addEventListener("mouseup",function(e){i(e),a=!1,n.media.play(),n.media.isUserClick=!0,n.slider.addEventListener("mousemove",i)})}),n.media.addEventListener("timeupdate",function(e){n.updateTimeline(e)})},buildTime:function(){var e=this,t=document.createElement("div");t.className="zy_time",t.innerHTML='<span class="zy_currenttime">'+u(0,e.options)+'</span>/<span class="zy_duration">'+u(e.options.duration,e.options)+"</span>",e.controls.appendChild(t),e.currentTime=t.children[0],e.durationDuration=t.children[1],e.media.addEventListener("timeupdate",function(){e.updateTime()})},buildFullscreen:function(){var t=this;if("-"!=r.features.nativeFullscreenPrefix){document.addEventListener(r.features.nativeFullscreenPrefix+"fullscreenchange",function(e){t.isFullScreen&&(o()||t.exitFullScreen())})}t.fullscreenBtn=document.createElement("div"),t.fullscreenBtn.className="zy_fullscreen_btn",t.controls.appendChild(t.fullscreenBtn),t.fullscreenBtn.addEventListener("click",function(){"-"!=r.features.nativeFullscreenPrefix&&o()||t.isFullScreen?t.exitFullScreen():t.enterFullScreen()})},buildDec:function(){var t=this,i=document.createElement("div");i.className="dec_loading",i.style.display="none",t.container.appendChild(i);var n=document.createElement("div");n.className="dec_error",n.style.display="none",n.innerHTML="播放异常",t.container.appendChild(n);var a=document.createElement("div");r.features.isVendorBigPlay||(a.className="dec_play",t.container.appendChild(a),a.addEventListener("click",function(){t.media.isUserClick=!0,t.media.play(),t.media.paused||t.options.alwaysShowControls||t.setControlsTimer(3e3)})),t.media.addEventListener("play",function(){t.media.isUserClick&&(a.style.display="none",i.style.display="",t.buffering.style.display="none")}),t.media.addEventListener("playing",function(){a.style.display="none",i.style.display="none",t.buffering.style.display="none",n.style.display="none"}),t.media.addEventListener("seeking",function(){i.style.display="",a.style.display="none",t.buffering.style.display=""}),t.media.addEventListener("seeked",function(){i.style.display="none",t.buffering.style.display="none"}),t.media.addEventListener("pause",function(){a.style.display=""}),t.media.addEventListener("waiting",function(){i.style.display="",a.style.display="none",t.buffering.style.display=""}),t.media.addEventListener("error",function(e){i.style.display="none",a.style.display="",t.buffering.style.display="none",t.media.pause(),n.style.display="","function"==typeof t.options.error&&t.options.error(e)})},init:function(){var i=this,e=["Container","Playpause","Timeline","Time"];i.options.enableFullscreen&&i.isVideo&&e.push("Fullscreen"),i.isVideo&&e.push("Dec");for(var t=0;t<e.length;t++)try{i["build"+e[t]]()}catch(e){}i.isVideo&&(r.features.hasTouch?i.media.addEventListener("click",function(){i.isControlsVisible?i.hideControls():(i.showControls(),i.media.paused||i.options.alwaysShowControls||i.setControlsTimer(3e3))}):(i.media.addEventListener("click",function(){i.media.paused?i.media.play():i.media.pause()}),i.container.addEventListener("mouseenter",function(){i.showControls(),i.options.alwaysShowControls||i.setControlsTimer(3e3)}),i.container.addEventListener("mousemove",function(){i.showControls(),i.options.alwaysShowControls||i.setControlsTimer(3e3)})),i.options.hideVideoControlsOnLoad&&i.hideControls(),i.media.addEventListener("loadedmetadata",function(e){i.enableAutoSize&&setTimeout(function(){isNaN(i.media.videoHeight)||i.setPlayerSize()},50)})),i.media.addEventListener("play",function(){var e;for(var t in r.players)if((e=r.players[t]).id!=i.id&&i.options.pauseOtherPlayers&&!e.paused&&!e.ended)try{e.media.pause()}catch(e){}}),i.options.enableVisibilityState&&r.features.vChange&&(document.addEventListener(r.features.vChange,function(){"hidden"==document[r.features.vState]&&setTimeout(function(){[].forEach.call(document.querySelectorAll("video, audio"),function(e){e.pause()})},100)}),r.features.vChange=""),window.addEventListener("orientationchange",function(){o()||i.isFullScreen||setTimeout(function(){i.setPlayerSize()},500)}),i.media.addEventListener("ended",function(e){i.media.currentTime=0,i.options.autoLoop?i.media.play():(i.isVideo&&setTimeout(function(){i.container.querySelector(".dec_loading").style.display="none"},20),i.media.pause()),i.updateTimeline(e)}),i.media.addEventListener("loadedmetadata",function(e){i.updateTime()}),i.options.autoplay&&(i.media.isUserClick=!1,i.media.play()),"function"==typeof i.options.success&&i.options.success(i.media)}},window.zymedia=function(e,t){"string"==typeof e?[].forEach.call(document.querySelectorAll(e),function(e){new r.MediaPlayer(e,t)}):new r.MediaPlayer(e,t)}}();